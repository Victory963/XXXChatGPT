## コーディング規約 JSP
### 1 本書について
#### 1.1 目的
本規約は、JSPのコーディングを行う際に参照する規約や推奨事項を示したものである。本規約を参照することで、JSPを用いたソースコードの品質水準を一定以上に維持し、保守性の高いソフトウェアを作成することを目的とする。
#### 1.2 実行環境
|項目|前提条件|
|--|--|
|efw|3.0以上|
|サポートブラウザ|・IE 10以上、IE Edge推奨|
||・Firefox 最新|
||・Google Chrome 最新|
||・Safari 未確認|
||・Android　未確認|

### 2 フォーマットに関する基準
#### 2.1 【必須】文字コードについて
##### 2.1.1 文字コードはUTF-8（BOMなし）とする
プログラムの文字コードは、UTF-8でBOMなしとすること。
#### 2.2 【必須】コメントの記述形式に関する基準について
##### 2.2.1 HTMLのコメント基準
HTMLのコメント記述は、`<!--  -->`を使用すること。

例：
```html
<!-- 検索条件を入力するエリア -->
<TD>検索条件①</TD>
<TD><INPUT TYPE="TEXT" ID="txt_searchCon1" STYLE="IME-MODE: DISABLED" MAXLENGTH=20></TD>
<TD>検索条件①</TD>
<TD><INPUT TYPE="TEXT" ID="txt_searchCon2" STYLE="IME-MODE: DISABLED" MAXLENGTH=20></TD>
```
##### 2.2.2 JavaScriptのコメント基準
可読性を向上させるため、必要に応じてJavaScriptの説明をコメントとして記述すること。
下記にコメントの基準と記述例を示す
|No|コメント|
|--|--|
|1|(`/*  */`)形式のブロックコメント|
|2|({`//`)形式の１行コメント|

例：
```js
/**	
	複数行コメント（ブロックコメント）です。
	…
**/	
function init() {	
	// 1行コメントです。
	$('#txt_userName').focus();
	･･･
}	
```
#### 2.3 【推奨】大文字と小文字について
##### 2.3.1 HTMLは可能な限り大文字で記述する
一部の属性値（例：パスを記載する属性値）以外、大文字で記述する。

例：
```html
<HEAD>	
	<TITLE>パスワード変更</TITLE>
	<META CONTENT="TEXT/HTML;CHARSET=UTF-8" HTTP-EQUIV="CONTENT-TYPE">
	<LINK REL=STYLESHEET TYPE=TEXT/CSS HREF="css/style.css">
	･･･
</HEAD>	
```
Eclipseでソースを大文字に変換する操作手順：
- HTMLソースを選択し右クリックでメニューを表示する。
- そのメニューの【変換】を選択し、サブメニューで【大文字に変換】を選択する。
※ショートカットキー：Ctrl + Alt + U

例外：
efwタグは上記規約を適用しない
```html
<BODY ONLOAD="Efw('T02_search')">		
	<efw:Part path="T03.jsp" />	
	<efw:Part path="T04.jsp" />	
	<DIV>	
		<efw:Part path="head.jsp" title="親代理店一覧" />
	･･･	
</BODY>		
```

### 3 命名規約
#### 3.1 【推奨】ファイル名
##### 3.1.1 共通ファイルの命名基準
使用目的を示し、英数字の名前とする。

例：
|共通ファイル|説明|
|--|--|
|head.jsp|システムヘッダ部の情報を記述する|
|error.jsp|システムエラー時に表示する画面とメッセージ内容を記述する|
|paging.jsp|画面のページング処理を記述する|
##### 3.1.2 業務関連ファイルの命名基準
システムのコード体系に従い、命名する。
例：
業務内容に基づいて以下分類を行い、各分類名称の略語と連番にして連結する
|分類|分類名称の略語|連番（２桁）|サンプル|
|--|--|--|--|
|ログイン関連|LG|01、02・・・|LG01.jsp、LG02.jsp|
|システム関連|SM|同上|SM01.jsp、SM02.jsp|
|トランザクション関連|TS|同上|TS01.jsp、TS02.jsp|
|マスタ関連|MT|同上|MT01.jsp、MT02.jsp|
#### 3.2 【推奨】JavaScript関数の命名について
※JSPにおいてJavaScript関数はできるかぎり記述しない
##### 3.2.1 業務関連関数の命名基準
- 動詞または動詞＋名詞となるように命名する
- ローワーキャメルケース(lower camel case)を使う
単語の先頭を大文字にしてつなげる
最初の文字を小文字にする

例：
|違反サンプル|修正サンプル|
|--|--|
|userRowSelect|selectUserRow|
##### 3.2.2 html イベントハンドラより呼出し関数の命名基準
イベントハンドラ名に要素のID名あるいはClass名をつける
例：
|イベントハンドラ|サンプル|
|--|--|
|ONLOAD|body_onLoad|
|ONCLICK|btn_add_onClick|
|ONDBLCLICK|btn_del_dblClick|

#### 3.3 【推奨】ローカル変数の命名について
##### 3.3.1 タグID
コントロール種類に基づいて分類し、各分類の略語を先頭につける。
|No.|HTML要素|タイプ属性|接頭文字|
|--|--|--|--|
|1|INPUT|text|txt_|
|2||password|pw_|
|3||checkbox|chk_|
|4||radio|radio_|
|5||button|btn_|
|6||file|file_|
|7||hidden|hid_|
|8|TEXTAREA|-|txta_|
|9|SELECT|-|sel_|

例：
```html
<TD>検索条件①</TD>
<TD><INPUT TYPE="TEXT" ID="txt_searchCon1" STYLE="IME-MODE: DISABLED" MAXLENGTH=20></TD>
<TD>検索条件①</TD>
<TD><INPUT TYPE="TEXT" ID="txt_searchCon2" STYLE="IME-MODE: DISABLED" MAXLENGTH=20></TD>
```
##### 3.3.2 HTMLのCLASS
- デザイン関連のCLASSについては、制限しない
- 業務関連のCLASSについては、HTMLのID命名規則に従う
※ダイアログ画面用のID（DIVタグ内で）を定義する場合、ダイアログ画面の要素についてCLASSで定義すること。

例：
```html
<!--ダイアログ画面はIDで定義-->
<DIV CLASS="DIALOG" ID="S02" STYLE="DISPLAY:NONE">			
	<TABLE STYLE="WIDTH:100%">		
		<COLGROUP>	
			<COL WIDTH=100PX>
			<COL>
		</COLGROUP>	
<!--ダイアログ画面の要素はCLASSで定義-->
		<TR><TD>ユーザID</TD><TD><INPUT CLASS="txt_userId" TYPE="TEXT" ･･･></TD></TR>	
		<TR><TD>ユーザ名</TD><TD><INPUT CLASS="txt_userName" TYPE="TEXT" ･･･></TD></TR>	
		<TR><TD>メールアドレス</TD><TD><INPUT CLASS="txt_eMail" TYPE="TEXT" ･･･> 	
	</TABLE>		
	<DIV STYLE="TEXT-ALIGN:CENTER">		
		<BUTTON ONCLICK="Efw('S02_save')">保存</BUTTON>	
		<BUTTON ONCLICK="Efw('S01_search');S02.dialog('close');">閉じる</BUTTON>	
	</DIV>		
</DIV>			
```

##### 3.3.3 JavaScriptの変数
変数名はハンガリアン記法（Hungarian notation）を使う
変数名の先頭に小文字でデータ種類を示す接頭文字を付ける
|データの種類|接頭文字|使用例|
|--|--|--|
|String 型|str|var strFileName = "";|
|Number 型|num|var numHeight = 0;|
|Boolean 型|bln|var blnDutyFlag = true;|
|Array 型|arr|var arrAnimals = ['dog', 'cat'];|

例外：
配列の中身を逐次処理するループカウンタ変数は、i,j,keyなどを使用する。
#### 3.4 URLパラメータについて
##### 3.4.1 【必須】標準的なパラメータのみ使用する
標準的なパラメータ：クエッションマーク (?) の後にある変数値がイコール (＝) で示す
##### 3.4.2 【推奨】パラメータの命名について
小文字で記述する。
##### 3.4.3 【必須】パラメータの値について
コード類のみ使用可とする。
※名称類を引き渡すと、エンコードの問題があるので、名称類を使用不可とする。




## コーディング規約 Event JS
### 1 本書について
#### 1.1 目的
本書は、efwにおいて、「event」フォルダー配下のJavaScriptのコーディングを行う際に参照する規約や推奨事項を示したものである。本書を参照することで、JavaScriptを用いたソースコードの品質水準を一定以上に維持し、保守性の高いソフトウェアを作成することを目的とする。

### 2 フォーマットに関する基準
#### 2.1 【必須】文字コードについて
##### 2.1.1 文字コードはUTF-8（BOMなし）とする
プログラムの文字コードは、UTF-8でBOMなしとすること。
#### 2.2 【推奨】フォーマット
##### 2.2.1 インデント基準
eclipseのデフォルト設定を流用する。
インデントに利用する文字 　→　タグ
インデント・サイズ　　→　　4文字
eclipseのインデント設定変更手順
フォーマッターがカスタマイズされて、上記基準に合わない場合、eclipseでインデントの設定変更が可能です。
① ウィンドウ -> 設定 -> JavaScript -> コードスタイル -> フォーマッター
② 上記画面の編集ボタン押下よりアクティブなプロファイルの編集画面が表示される
###### 2.2.2 改行基準
基本：
①文が長く、120文字の制限を超えてしまう場合適切に改行を行う。
②読みやすい形式で改行を行う。

下記の場合、改行基準を定める。
① Params Formatの場合
引数ごとに改行を行う。

例：
```js
K01_search.paramsForma{																		
		"#txt_name":null,					//コメント							
		"#txt_address":null,				//コメント							
		"#txt_age":null						//コメント							
};																		
```

② DB操作関数呼出しの場合
引数ごとに改行を行う。

例：
```js
var rsM_USER = db.select(												
		"T02",								//コメント		
		"selM_USER",						//コメント		
		{・・・}							//コメント		
		);																				
```

③ Recordのmap関数を使用する場合
引数ごとに改行を行う。

例：
```js
var arrM_USER = rsM_USER.map({
	"strA":"data1",							//コメント		
	"strB":["data2","#,##0"],				//コメント		
	"strC":["data3","yyyy/MM/dd"]			//コメント		
}).getArray();
```

④ メソッドチェーンの場合
メソッドの前で行を行う。

例：
```js
return (new Result())																
	.runat("#sel_county1")										　//コメント	
	.append("<option value='{strCounty}'>{strCounty}</option>")														//コメント	
	.withdata(data)												　//コメント	
	.runat("#sel_county2")										　//コメント	
	.append("<option value='{strCounty}'>{strCounty}</option>")														//コメント	
	.withdata(data);											　//コメント	
```

⑤ 式が長い場合
演算子の直後で改行を行う

例：
```js
.append("<tr>" +																	
		"<td title='{strA}'>{strA}</td>" +							//コメント		
		"<td title='{strB}'>{strB}</td>" +							//コメント		
		"<td title='{strC}'>{strC}</td>" +							//コメント		
		"<td title='{strD}'>{strD}</td>" +							//コメント		
		"<td title='{strE}'>{strE}</td>" +							//コメント		
		"</tr>")													
```

#### 2.3 【推奨】Eclipseのデフォルトフォーマッタを適用しないこと
Eclipseのデフォルトフォーマッタの適用によりソースの可読性が落ちる恐れがあるため、Eclipseのデフォルトフォーマッタを適用しない。

例：
Eclipseのフォーマッタの適用前
```js
.append("<tr>" +																	
		"<td title='{strA}'>{strA}</td>" +							//コメント		
		"<td title='{strB}'>{strB}</td>" +							//コメント		
		"<td title='{strC}'>{strC}</td>" +							//コメント		
		"<td title='{strD}'>{strD}</td>" +							//コメント		
		"<td title='{strE}'>{strE}</td>" +							//コメント		
		"</tr>")													
```

Eclipseのフォーマッタの適用後
```js
.append(
	"<tr>" + "<td title='{strA}'>{strA}</td>" + "<td title='{strB}'>{strB}</td>" + "<td title='{strC}'>{strC}</td>" + "<td title='{strD}'>{strD}</td>" + "</tr>"
)																						
```

#### 2.4 【必須】コメントの記述形式
目的別にコメント記号を使い分ける。
定義したオブジェクトのAPI仕様を記述するコメントと、それ以外の可読性向上を目的としたインラインコメントで、
コメント記号をを使い分けること。それぞれ利用するコメント記号は、下記記述例の通りとする。
##### 2.4.1 API仕様を記述するコメント
```js
/**							
 * 桁数をチェックする							
 * @param {number} 最大桁数							
 * @param {number} 最小桁数							
 * @return {boolean} チェック結果							
 */							
```
###### 2.4.2 インラインコメント
・複雑なロジックを理解するためのヒントを記述
・以下ソースの箇所はインラインコメントの記述を推奨する
① Params Format													
	各パラメータの説明								例：　2.2.2 ①　を参照				
② DB操作関数呼出し													
	各パラメータの説明								例：　2.2.2 ②　を参照				
③ Recordのmap関数													
	各パラメータの説明								例：　2.2.2 ③　を参照				
④ メソッドチェーン													
	各メソッドの説明								例：　2.2.2 ④　を参照				

#### 2.5 【必須】セミコロンの基準について
##### 2.5.1  文末のセミコロンは省略しない
文末のセミコロン「;」は、JavaScriptの言語仕様としては省略可能であるが、可読性を高めるため、
そしてミニファイ実施後のスクリプトが実行時にエラーとなる可能性があるため、必須とする。

禁止する例：
```js
var strHoge = ""
```
守るべき例：
```js
var strHoge = "";
```
#### 2.6 【必須】記法
##### 2.6.1 オブジェクトの定義
オブジェクトの生成は、オブジェクトリテラルによる生成する。

例：
```js
var objCustomer = {															
		"strName" : "taro",											//コメント	
		"numAge" : 22,												//コメント	
		"check"：function(numMaxDigit, numMinDigit){                //コメント
			//...
		} 														
};															
```															
###### 2.6.2  配列の定義
配列は配列リテラルを使って配列を宣言する。（new演算子によるオブジェクトの生成は行わない。）
禁止する例：
```js
var arrAnimals = new Array('dog', 'cat');
```
守るべき例：
```js
var arrAnimals = {'dog', 'cat'};
```

### 3 ファイルの粒度
#### 3.1 【必須】画面のイベント毎にjsファイルを作成する。
複雑な処理、共通的な処理の場合、業務に合わせてファイルを分割する。
※1jsファイルの行数を1000行位とする。
#### 3.2 【推奨】業務処理毎にjsファイルを作成する。

### 4 命名規約
#### 4.1 イベントID
##### 4.1.1 【必須】画面のイベント毎に作成したjsファイルの場合
イベントID　：　「画面ID + "_" + イベント名」
イベント名について：														
	①　動詞または動詞＋名詞となるように命名する													
	②　ローワーキャメルケース(lower camel case)を使う												
														
例：　														
	ログイン画面（LG01）のクリアボタン押下時→　"LG01_clear"	

###### 4.1.2 【推奨】業務処理毎に作成したjsファイルの場合
イベントID　：　「業務ID」
###### 4.1.3 【推奨】サブフォルダーについて
必要に応じて（大規模開発等）、「event」フォルダーの配下にサブフォルダーを作成することは可能です。
サブフォルダーを作成する場合、イベントIDの中にパスを含む必要がある。

例：															
　　「LG」サブフォルダーを作成した場合、														
	ログイン画面（LG01）のクリアボタン押下時　→　"LG/LG01_clear"														

#### 4.2 【必須】ファイル名
「イベントID + ".js"」とする。
※イベントIDの中にパスが含まれている場合、サブフォルダーを作成して、ファイル名からパスを除く。

例：
LG01_clear.js																					

#### 4.3 【推奨】関数
①　動詞または動詞＋名詞となるように命名する
②　ローワーキャメルケース(lower camel case)を使う
　・単語の先頭を大文字にしてつなげる
　・最初の文字を小文字にする

例：
行編集ボタンのクリックイベント　→　editRow

#### 4.4 パラメータ
##### 4.4.1 【必須】セレクター
JSPの画面要素の名前にあわせる。
###### 4.4.2 【推奨】マニュアルパラメータ
小文字で記述する。

例：
JSファイル
```js
T01_maintain.paramsFormat={						
		// 名前				
		"#txt_name":null,				
		// 住所				
		"#txt_address":null,				
		// 年齢				
		"#txt_age":null,				
		// 処理モード				
		"mode":null				
};						
```
JSファイル
```js
	// 完了解除												
	function edit(){												
		var strMode = "edit";												
		Efw("T01_maintain",												
				{												
					"mode":strMode												
				}												
			);												
		}												
	…												
	<TD>名前</TD>												
	<TD><INPUT TYPE="TEXT" ID="txt_name" …></TD>												
	<TD>住所</TD>												
	<TD><INPUT TYPE="TEXT" ID="txt_address" …></TD>												
	<TD>年齢</TD>												
	<TD><INPUT TYPE="TEXT" ID="txt_age" …></TD>												
```
#### 4.5 【推奨】ローカル変数
##### 4.5.1 ハンガリアン記法（Hungarian notation）を使う
変数名の先頭に小文字でデータ種類を示す接頭文字を付ける
|データの種類|接頭文字|使用例
|--|--|--|
|String 型|str|var strFileName = "";|	
|Number 型|num|var numHeight = 0;|	
|Boolean 型|bln|var blnDutyFlag = true;|
|Array 型|arr|var arrAnimals = ['dog', 'cat'];|	
|Object 型|obj|var objCustomer = {};|	
|RecordSet (DB検索結果など)|rs|var rs診断テーブル = db.select("TO2", "sel診断テーブル", {});|
|RecordSet(Array)|arr|var arr診断テーブル = db.select("TO2", "sel診断テーブル", {}).getArray();|
|RecordSet(row)|data|var data診断テーブル = db.select("TO2", "sel診断テーブル", {}).getSingle();|
|Parameter|param|var paramFileName = "";|
|Result (返却する結果)|rst|var rstSearch = new Result();|

例外：
配列の中身を逐次処理するループカウンタ変数は、i,j,kなどを使用する。

###### 4.5.2 DB操作に関連する変数
DBのテーブルの名前、項目の名前を使用して命名する。
※DBのテーブルの名前、項目の名前は日本語で命名されている場合、変数名の中で日本語も使用可能
例：
DBのテーブルの名前を使用して命名する例
```js
var rs診断テーブル = db.select(							
		"T02",							
		"sel診断テーブル",							
		{}							
		);
```
DBの項目の名前を使用して命名する例
```js
var strKijunnDate = 					
	db.select(					
		"T01",					
		"selKijunnDate",					
		{}					
		).getSingle();					
```
###### 4.5.3　 画面から渡されたパラメータを使用して何らかの処理を行う場合に定義するローカル変数について
画面の要素の名前を使用して命名する。

例：
```js
var strFreeWord = params["#txt_freeWord"]
```




## コーディング規約 外だしSQL
### 1 本書について
#### 1.1 目的
本書は、efwにおいて、「sql」フォルダー配下のXMLファイルに外だしSQLのコーディングを行う際に
性能、保守性等に留意した記述を行うための基準集である。
### 2 フォーマットに関する基準
#### 2.1 【必須】文字コードについて
##### 2.1.1 文字コードはUTF-8（BOMなし）とする
プログラムの文字コードは、UTF-8でBOMなしとすること。
#### 2.2 【推奨】SQLフォーマット

### 3 ファイルの粒度


### 4 命名規約


### 5 SQLコーディング内容に関する基準


### 6 XMLコーディング内容に関する基準
